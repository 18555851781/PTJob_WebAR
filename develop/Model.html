<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0, maximum-scale=1.0,user-scalable=no">
    <title>
        Model
    </title>
    <script src="../three.js/examples/vendor/three.js/build/three.js"></script>
    <script src="../three.js/examples/vendor/three.js/examples/js/loaders/GLTFLoader.js"></script>
    <script src="../three.js/examples/vendor/three.js/examples/js/controls/OrbitControls.js"></script>
    <script src="../three.js/examples/vendor/three.js/examples/js/loaders/OBJLoader.js"></script>
    <script src="../three.js/examples/vendor/three.js/examples/js/loaders/MTLLoader.js"></script>

    <style>
        *{
            padding: 0;
            margin: 0;
        }
        .UI_Body{
            position: fixed;
        }
        .Text{
            position: fixed;
            width: 265px;
            left: 0%;
            bottom: 0%;
            font-size: x-small;
            margin: 5px;
        }
        .Image{
            position: fixed;
            bottom: 0%;
            right: 0%;
            width: 110px;
            height: 84px;
        }
        .Mask{
            position: fixed;
            width: 100%;
            height: 100%;
        }
        .Load{
            position: fixed;
            top: 50%;
            left: 50%;
            width: 80%;
            height: 80%;
            transform: translate(-50%,-60%);
        }

    </style>
</head>
<body>
    <div class="UI_Body">
        <div class="UI">
            <img src="../Model/Texture/WechatIMG129.png" class="Image">
            <p class="Text">拨浪鼓是一种古老又传统的民间乐器和玩具，出现于战国时期。拨浪鼓的主体是一面小鼓，两侧缀有两枚弹丸，鼓下有柄，转动鼓柄弹丸击鼓发出声音。鼓身可以是木的也可以是竹的，还有泥的、硬纸的；鼓面用羊皮、牛皮、蛇皮或纸制成，其中以木身羊皮面的拨浪鼓最为典型。</p>
            <div id="Mask" class="Mask">
                <img src="../Model/Texture/BLG.jpg" class="Load">
            </div>
        </div>
        <div class="Display">
            <script>

                function init()
                {
                    var OBJ_GuBin,OBj_GuSheng,OBj_HouGuMian,OBj_QianGuMian,OBj_YouGuChui,OBj_ZuoGuChui;
                    var IsGetObj = false;

                    var scene = new THREE.Scene();

                    var camera = new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,1000);
                    camera.position.z = 5;

                    var pointlight = new THREE.PointLight(0xffffff,2);
                    pointlight.position.set(-10,10,-10);
                    scene.add(pointlight);

                    var pointlight_2 = new THREE.PointLight(0xffffff,2);
                    pointlight_2.position.set(-10,10,10);
                    scene.add(pointlight_2);

                    var pointlight_3 = new THREE.PointLight(0xffffff,2);
                    pointlight_3.position.set(10,0,0);
                    scene.add(pointlight_3);

                    var renderer = new THREE.WebGLRenderer();
                    renderer.setSize(window.innerWidth,window.innerHeight);
                    renderer.setClearColor(new THREE.Color(0xffffff),1.0);
                    //  重要！！！将元素渲染到html元素上 否则不显示
                    var dom_renderer=renderer.domElement;
                    document.body.appendChild(dom_renderer);

                    //  不显示加载图片
                    function LoadDisplay()
                    {
                        var Mask = document.getElementById("Mask");
                        Mask.style.display = "none";
                    }

                    //  禁止下拉刷新
                    function NoPull() {
                        document.body.addEventListener('touchmove',(e)=>
                            {e.preventDefault();},
                            {passive : false}
                        )
                    }
                    NoPull();
                    
                    //  实现双击屏幕事件
                    function TouchTwice()
                    {

                    }


                    //  对模型进行操作
                    function ControlModel(model)
                    {
                        console.log(model);

                        //model.translateOnAxis(new THREE.Vector3(x,y,z),0.1);

                        model.position.x+=0.01;

                    }

                    //  加载模型并初始化
                    function Load()
                    {
                        var loader_1 = new THREE.MTLLoader();
                        loader_1.setPath('../Model/OBJ/');
                        loader_1.setTexturePath('../Model/OBJ/');
                        loader_1.load('BLG_GuSheng.mtl',function (material) {
                            //  预加载
                            material.preload();

                            var Loadobj = new THREE.OBJLoader();
                            Loadobj.setMaterials(material);
                            Loadobj.setPath('../Model/OBJ/');
                            Loadobj.load('BLG_GuSheng.obj',function (obj) {
                                obj.scale.set(0.002,0.002,0.002);
                                obj.position.y = 1.5;
                                obj.name = "GuSheng";
                                OBj_GuSheng = obj;
                                //OBJ_Group.add(OBj_GuSheng);
                                scene.add(obj);
                            });
                        })

                        var loader_2 = new THREE.MTLLoader();
                        loader_2.setPath('../Model/OBJ/');
                        loader_2.setTexturePath('../Model/OBJ/');
                        loader_2.load('BLG_GuBin.mtl',function (material) {
                            //  预加载
                            material.preload();

                            var Loadobj = new THREE.OBJLoader();
                            Loadobj.setMaterials(material);
                            Loadobj.setPath('../Model/OBJ/');
                            Loadobj.load('BLG_GuBin.obj',function (obj) {
                                obj.scale.set(0.002,0.002,0.002);
                                obj.position.y = 1.5;
                                obj.name = "GuBin";
                                OBJ_GuBin = obj;
                                //OBJ_Group.add(OBJ_GuBin);
                                scene.add(obj);
                            })
                        })

                        var loader_3 = new THREE.MTLLoader();
                        loader_3.setPath('../Model/OBJ/');
                        loader_3.setTexturePath('../Model/OBJ/');
                        loader_3.load('BLG_HouGuMian.mtl',function (material) {
                            //  预加载
                            material.preload();

                            var loadobj = new THREE.OBJLoader();
                            loadobj.setMaterials(material);
                            loadobj.setPath('../Model/OBJ/');
                            loadobj.load('BLG_HouGuMian.obj',function (obj) {
                                obj.scale.set(0.002,0.002,0.002);
                                obj.position.y = 1.5;
                                obj.name = "HouGuMian";
                                OBj_HouGuMian = obj;
                                //OBJ_Group.add(OBj_HouGuMian);
                                scene.add(obj);
                            })
                        })

                        var loader_4 = new THREE.MTLLoader();
                        loader_4.setPath('../Model/OBJ/');
                        loader_4.setTexturePath('../Model/OBJ/');
                        loader_4.load('BLG_QianGuMian.mtl',function (material) {
                            //  预加载
                            material.preload();

                            var loadobj = new THREE.OBJLoader();
                            loadobj.setMaterials(material);
                            loadobj.setPath('../Model/OBJ/');
                            loadobj.load('BLG_QianGuMian.obj',function (obj) {
                                obj.scale.set(0.002,0.002,0.002);
                                obj.position.y = 1.5;
                                obj.name = "QianGuMian";
                                OBj_QianGuMian = obj;
                                //OBJ_Group.add(OBj_QianGuMian);
                                scene.add(obj);
                            })
                        })

                        var loader_5 = new THREE.MTLLoader();
                        loader_5.setPath('../Model/OBJ/');
                        loader_5.setTexturePath('../Model/OBJ/');
                        loader_5.load('BLG_ZuoGuChui.mtl',function (material) {
                            //  预加载
                            material.preload();

                            var loadobj = new THREE.OBJLoader();
                            loadobj.setMaterials(material);
                            loadobj.setPath('../Model/OBJ/');
                            loadobj.load('BLG_ZuoGuChui.obj',function (obj) {
                                obj.scale.set(0.002,0.002,0.002);
                                obj.position.y = 1.5;
                                obj.name = "ZuoGuChui";
                                OBj_ZuoGuChui = obj;
                                //OBJ_Group.add(OBj_ZuoGuChui);
                                scene.add(obj);
                            })
                        })

                        var loader_6 = new THREE.MTLLoader();
                        loader_6.setPath('../Model/OBJ/');
                        loader_6.setTexturePath('../Model/OBJ/');
                        loader_6.load('BLG_YouGuChui.mtl',function (material) {
                            //  预加载
                            material.preload();

                            var loadobj = new THREE.OBJLoader();
                            loadobj.setMaterials(material);
                            loadobj.setPath('../Model/OBJ/');
                            loadobj.load('BLG_YouGuChui.obj',function (obj) {
                                obj.scale.set(0.002,0.002,0.002);
                                obj.position.y = 1.5;
                                obj.name = "YouGuChui";
                                OBj_YouGuChui = obj;
                                //OBJ_Group.add(OBj_YouGuChui);
                                scene.add(obj);
                            })
                        })
                    }
                    Load();

                    //  第一帧的时候获取不到 必须要重复获取才可以

                    function Move()
                    {
                        if(OBJ_GuBin !== undefined && OBj_YouGuChui !== undefined && OBj_ZuoGuChui !== undefined && OBj_QianGuMian !== undefined && OBj_HouGuMian !== undefined && OBj_GuSheng!== undefined && !IsGetObj)
                        {
                            IsGetObj = true;

                            LoadDisplay();
                        }

                        if(IsGetObj)
                        {
                            ControlModel(OBJ_GuBin);
                        }

                    }

                    setInterval(Move,1000);

                    camera.lookAt(scene.position);

                    var control = new THREE.OrbitControls(camera);
                    control.autoRotate = true;

                    function render()
                    {
                        requestAnimationFrame(render);
                        renderer.render(scene,camera);
                    }
                    render();
                }
                window.onload = init;

            </script>
        </div>
    </div>
</body>
</html>